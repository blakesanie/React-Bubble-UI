{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import React, { useState, useLayoutEffect, useRef } from \"react\";\r\nimport styles from \"./styles.module.css\";\r\n\r\nexport const defaultOptions = {\r\n  size: 200,\r\n  minsize: 20,\r\n  gutter: 16,\r\n  provideprops: false,\r\n  numcols: 6,\r\n  fringewidth: 100,\r\n  yradius: 200,\r\n  xradius: 200,\r\n  cornerradius: 100,\r\n  showguides: false,\r\n  compact: false,\r\n  gravitation: 0,\r\n};\r\n\r\nexport default function BubbleElement(props) {\r\n  if (!props.children) {\r\n    return null;\r\n  }\r\n  let options = {};\r\n  Object.assign(options, defaultOptions);\r\n  Object.assign(options, props.options);\r\n  options.numcols = Math.min(options.numcols, props.children.length);\r\n  // console.log(options);\r\n\r\n  const minProportion = options.minsize / options.size;\r\n\r\n  const verticalPadding = `calc(50% - ${\r\n    options.yradius +\r\n    options.size / 2 -\r\n    (options.cornerradius * (1.414 - 1)) / 1.414\r\n  }px)`;\r\n  const horizontalPadding = `calc(50% - ${\r\n    options.xradius +\r\n    options.size / 2 -\r\n    (options.cornerradius * (1.414 - 1)) / 1.414\r\n  }px)`;\r\n\r\n  const scrollable = useRef(null);\r\n\r\n  let rows = [];\r\n  var colsRemaining = 0;\r\n  var evenRow = true;\r\n  for (var i = 0; i < props.children.length; i++) {\r\n    if (colsRemaining == 0) {\r\n      colsRemaining = evenRow ? options.numcols - 1 : options.numcols;\r\n      evenRow = !evenRow;\r\n      rows.push([]);\r\n    }\r\n    rows[rows.length - 1].push(props.children[i]);\r\n    colsRemaining--;\r\n  }\r\n  if (rows.length > 1) {\r\n    if (rows[rows.length - 1].length % 2 == rows[rows.length - 2].length % 2) {\r\n      rows[rows.length - 1].push(<div></div>); // dummy bubble\r\n    }\r\n  }\r\n\r\n  const [scrollTop, setScrollTop] = useState(0);\r\n  const [scrollLeft, setScrollLeft] = useState(0);\r\n\r\n  const handleScroll = (e) => {\r\n    if (e.target.className) {\r\n      setScrollTop(e.target.scrollTop);\r\n      setScrollLeft(e.target.scrollLeft);\r\n    }\r\n  };\r\n\r\n  // const handleResize = (e) => {\r\n  //   console.log('resize', e)\r\n  //   setElementHeight(container.current.clientHeight)\r\n  // }\r\n\r\n  useLayoutEffect(() => {\r\n    window.addEventListener(\"scroll\", handleScroll);\r\n\r\n    scrollable.current.scrollTo(\r\n      (scrollable.current.scrollWidth - scrollable.current.clientWidth) / 2,\r\n      (scrollable.current.scrollHeight - scrollable.current.clientHeight) / 2\r\n    );\r\n    return () => window.removeEventListener(\"scroll\", handleScroll);\r\n  }, []);\r\n\r\n  const interpolate = (actualMin, actualMax, val, targetMin, targetMax) => {\r\n    return (\r\n      ((val - actualMin) / (actualMax - actualMin)) * (targetMax - targetMin) +\r\n      targetMin\r\n    );\r\n  };\r\n\r\n  const getBubbleSize = (row, col) => {\r\n    const yOffset =\r\n      (options.size + options.gutter) * 0.866 * row -\r\n      options.size +\r\n      (options.cornerradius * (1.414 - 1)) / 1.414 -\r\n      (options.yradius - options.size);\r\n    //  - options.cornerradius / 1.414;\r\n    const xOffset =\r\n      (options.size + options.gutter) * col +\r\n      ((options.numcols - rows[row].length) * (options.size + options.gutter)) /\r\n        2 -\r\n      options.size +\r\n      (options.cornerradius * (1.414 - 1)) / 1.414 -\r\n      (options.xradius - options.size);\r\n    // - options.cornerradius / 1.414;\r\n    const dy = yOffset - scrollTop;\r\n    const dx = xOffset - scrollLeft;\r\n    const distance = Math.sqrt(dx * dx + dy * dy);\r\n    // let theta = Math.atan(dy / dx);\r\n    // if (dx < 0) theta += Math.PI;\r\n    let out = {\r\n      bubblesize: 1,\r\n      translatex: 0,\r\n      translatey: 0,\r\n      distance: distance,\r\n    };\r\n    let distanceFromEdge = 0;\r\n    let isInCornerRegion = false;\r\n    if (Math.abs(dx) <= options.xradius && Math.abs(dy) <= options.yradius) {\r\n      // inner square\r\n      if (\r\n        Math.abs(dy) > options.yradius - options.cornerradius &&\r\n        Math.abs(dx) > options.xradius - options.cornerradius\r\n      ) {\r\n        // in corner region\r\n        const distToInnerCorner = Math.sqrt(\r\n          Math.pow(Math.abs(dy) - options.yradius + options.cornerradius, 2) +\r\n            Math.pow(Math.abs(dx) - options.xradius + options.cornerradius, 2)\r\n        );\r\n        if (distToInnerCorner > options.cornerradius) {\r\n          // outside inner radius\r\n          distanceFromEdge = distToInnerCorner - options.cornerradius;\r\n          isInCornerRegion = true;\r\n        }\r\n      }\r\n    } else if (\r\n      Math.abs(dx) <= options.xradius + options.fringewidth &&\r\n      Math.abs(dy) <= options.yradius + options.fringewidth\r\n    ) {\r\n      // outer square\r\n      if (\r\n        Math.abs(dy) > options.yradius - options.cornerradius &&\r\n        Math.abs(dx) > options.xradius - options.cornerradius\r\n      ) {\r\n        // in corner region\r\n        isInCornerRegion = true;\r\n        const distToInnerCorner = Math.sqrt(\r\n          Math.pow(Math.abs(dy) - options.yradius + options.cornerradius, 2) +\r\n            Math.pow(Math.abs(dx) - options.xradius + options.cornerradius, 2)\r\n        );\r\n        distanceFromEdge = distToInnerCorner - options.cornerradius;\r\n        // distanceFromEdge = Math.min(\r\n        //   distToInnerCorner - options.cornerradius,\r\n        //   options.fringewidth\r\n        // );\r\n      } else {\r\n        distanceFromEdge = Math.max(\r\n          Math.abs(dx) - options.xradius,\r\n          Math.abs(dy) - options.yradius\r\n        );\r\n      }\r\n    } else {\r\n      // outside outer square\r\n      isInCornerRegion =\r\n        Math.abs(dy) > options.yradius - options.cornerradius &&\r\n        Math.abs(dx) > options.xradius - options.cornerradius;\r\n      if (isInCornerRegion) {\r\n        const distToInnerCorner = Math.sqrt(\r\n          Math.pow(Math.abs(dy) - options.yradius + options.cornerradius, 2) +\r\n            Math.pow(Math.abs(dx) - options.xradius + options.cornerradius, 2)\r\n        );\r\n        distanceFromEdge = distToInnerCorner - options.cornerradius;\r\n      } else {\r\n        distanceFromEdge = Math.max(\r\n          Math.abs(dx) - options.xradius,\r\n          Math.abs(dy) - options.yradius\r\n        );\r\n      }\r\n    }\r\n\r\n    out.bubblesize = interpolate(\r\n      0,\r\n      options.fringewidth,\r\n      Math.min(distanceFromEdge, options.fringewidth),\r\n      1,\r\n      minProportion\r\n    );\r\n\r\n    //handle magnitudes\r\n\r\n    const translationMag = options.compact\r\n      ? (options.size - options.minsize) / 2\r\n      : 0;\r\n    const interpolatedTranslationMag = interpolate(\r\n      0,\r\n      options.fringewidth,\r\n      distanceFromEdge,\r\n      0,\r\n      translationMag\r\n    );\r\n\r\n    if (distanceFromEdge > 0 && distanceFromEdge <= options.fringewidth) {\r\n      out.translatex = interpolatedTranslationMag;\r\n      out.translatey = interpolatedTranslationMag;\r\n    } else if (distanceFromEdge - options.fringewidth > 0) {\r\n      const extra =\r\n        (Math.max(\r\n          0,\r\n          distanceFromEdge - options.fringewidth - options.size / 2\r\n        ) *\r\n          options.gravitation) /\r\n        10;\r\n      out.translatex = translationMag + extra;\r\n      out.translatey = translationMag + extra;\r\n    }\r\n\r\n    if (isInCornerRegion) {\r\n      const cornerDx = Math.abs(dx) - options.xradius + options.cornerradius;\r\n      const cornerDy = Math.abs(dy) - options.yradius + options.cornerradius;\r\n      let theta = Math.atan(-cornerDy / cornerDx);\r\n      if (dx > 0) {\r\n        if (dy > 0) {\r\n          theta *= -1;\r\n        }\r\n      } else {\r\n        if (dy > 0) {\r\n          theta += Math.PI;\r\n        } else {\r\n          theta += Math.PI - 2 * theta;\r\n        }\r\n      }\r\n      out.translatex *= -Math.cos(theta);\r\n      out.translatey *= -Math.sin(theta);\r\n    } else if (\r\n      Math.abs(dx) > options.xradius ||\r\n      Math.abs(dy) > options.yradius\r\n    ) {\r\n      if (Math.abs(dx) > options.xradius) {\r\n        out.translatex *= -Math.sign(dx);\r\n        out.translatey = 0;\r\n      } else {\r\n        out.translatey *= -Math.sign(dy);\r\n        out.translatex = 0;\r\n      }\r\n    }\r\n\r\n    return out;\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={props.className}\r\n      style={{\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        ...props.style,\r\n      }}\r\n    >\r\n      <div className={styles.container}>\r\n        {/* <p>{`scrollTop: ${scrollTop}`}</p>\r\n        <p>{`scrollLeft: ${scrollLeft}`}</p> */}\r\n        <div\r\n          className={styles.scrollable}\r\n          ref={scrollable}\r\n          onScroll={handleScroll}\r\n        >\r\n          <div\r\n            className={styles.horizontalSpacer}\r\n            style={{\r\n              height: verticalPadding,\r\n            }}\r\n          ></div>\r\n          <div\r\n            className={styles.rowContainer}\r\n            style={{\r\n              width:\r\n                options.size * options.numcols +\r\n                options.gutter * (options.numcols - 1),\r\n              paddingLeft: horizontalPadding,\r\n              paddingRight: horizontalPadding,\r\n            }}\r\n          >\r\n            {rows.map((row, i) => {\r\n              return (\r\n                <div\r\n                  className={styles.row}\r\n                  key={i}\r\n                  style={{\r\n                    marginTop:\r\n                      i > 0\r\n                        ? options.size * -0.134 + options.gutter * 0.866 // .134 is sqrt(3) - 1\r\n                        : 0,\r\n                  }}\r\n                >\r\n                  {row.map((comp, j) => {\r\n                    const {\r\n                      bubblesize,\r\n                      translatex,\r\n                      translatey,\r\n                      distance,\r\n                    } = getBubbleSize(i, j);\r\n                    return (\r\n                      <div\r\n                        key={j}\r\n                        className={styles.bubbleContainer}\r\n                        style={{\r\n                          width: options.size,\r\n                          height: options.size,\r\n                          marginRight: options.gutter / 2,\r\n                          marginLeft: options.gutter / 2,\r\n                          transform: `translatex(${translatex}px) translatey(${translatey}px) scale(${bubblesize})`,\r\n                        }}\r\n                      >\r\n                        {options.provideprops\r\n                          ? React.cloneElement(comp, {\r\n                              bubblesize: bubblesize * options.size,\r\n                              distanceToCenter: distance,\r\n                              maxSize: options.size,\r\n                              minsize: options.minsize,\r\n                            })\r\n                          : comp}\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n          <div\r\n            className={styles.horizontalSpacer}\r\n            style={{\r\n              height: verticalPadding,\r\n            }}\r\n          ></div>\r\n        </div>\r\n\r\n        {options.showguides ? (\r\n          <div className={styles.guideContainer}>\r\n            <div\r\n              className={styles.guide}\r\n              style={{\r\n                height: options.yradius * 2,\r\n                width: options.xradius * 2,\r\n                borderRadius:\r\n                  options.shape == \"ellipse\" ? \"50%\" : options.cornerradius,\r\n              }}\r\n            ></div>\r\n            <div\r\n              className={styles.guide}\r\n              style={{\r\n                height: (options.yradius + options.fringewidth) * 2,\r\n                width: (options.xradius + options.fringewidth) * 2,\r\n                borderRadius:\r\n                  options.shape == \"ellipse\"\r\n                    ? \"50%\"\r\n                    : options.cornerradius + options.fringewidth,\r\n              }}\r\n            ></div>\r\n            {/* <div\r\n              style={{\r\n                position: \"absolute\",\r\n                height: `100%`,\r\n                width: 1,\r\n                backgroundColor: \"#000\",\r\n                left: `50%`,\r\n                top: 0,\r\n              }}\r\n            ></div>\r\n            <div\r\n              style={{\r\n                position: \"absolute\",\r\n                width: `100%`,\r\n                height: 1,\r\n                backgroundColor: \"#000\",\r\n                top: `50%`,\r\n                left: 0,\r\n              }}\r\n            ></div> */}\r\n          </div>\r\n        ) : null}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["defaultOptions","size","minsize","gutter","provideprops","numcols","fringewidth","yradius","xradius","cornerradius","showguides","compact","gravitation","BubbleElement","props","children","options","Object","assign","Math","min","length","minProportion","verticalPadding","horizontalPadding","scrollable","useRef","rows","colsRemaining","evenRow","i","push","React","createElement","_useState","useState","scrollTop","setScrollTop","_useState2","scrollLeft","setScrollLeft","handleScroll","e","target","className","useLayoutEffect","window","addEventListener","current","scrollTo","scrollWidth","clientWidth","scrollHeight","clientHeight","removeEventListener","interpolate","actualMin","actualMax","val","targetMin","targetMax","getBubbleSize","row","col","yOffset","xOffset","dy","dx","distance","sqrt","out","bubblesize","translatex","translatey","distanceFromEdge","isInCornerRegion","abs","distToInnerCorner","pow","max","translationMag","interpolatedTranslationMag","extra","cornerDx","cornerDy","theta","atan","PI","cos","sin","sign","style","_extends","display","justifyContent","alignItems","styles","container","ref","onScroll","horizontalSpacer","height","rowContainer","width","paddingLeft","paddingRight","map","key","marginTop","comp","j","_getBubbleSize","bubbleContainer","marginRight","marginLeft","transform","cloneElement","distanceToCenter","maxSize","guideContainer","guide","borderRadius","shape"],"mappings":"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"}